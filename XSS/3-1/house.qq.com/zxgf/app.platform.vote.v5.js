String.prototype.realCount=function(){return this.replace(/[^\x00-\xff]/g,"rr").length;};String.prototype.subTextStr=function(subLen){return this.substr(0,subLen);};String.prototype.trim=function(){return this.replace(/^(\s|　)*|(\s|　)*$/ig,"");};String.prototype.empty=function(){return this.trim()=="";};Number.prototype.format=function(){el=this.toString();if(el==''||el.length<=3){return el;}var index=el.length-1;var count=1;var result='';for(;index>=0;index--){result=el.substr(index,1)+result;if(index>0&&(count%3==0)){result=','+result;}count++;}return result;};try
{document.domain="qq.com";}catch(e){}if(typeof AppPlatform=="undefined"){var AppPlatform=new Object();}AppPlatform.$=function(s){return(typeof s=="object")?s:document.getElementById(s);};AppPlatform.Cookie={getCookie:function(name){var arr=document.cookie.match(new RegExp("(^| )"+name+"=([^;]*)(;|$)"));if(arr!=null){return window.unescape(arr[2]);}return null;}};AppPlatform.HashTable=function(){this.__construct();};AppPlatform.HashTable.prototype={__construct:function(){this._hash=new Object();},set:function(key,value,rewrite){if(rewrite!==false){this._hash[key]=value;}else if(this.get(key)!=null){this._hash[key]=value;}},get:function(key){if(typeof this._hash[key]!="undefined"){return this._hash[key];}else
{return null;}},remove:function(key){delete this._hash[key];}};AppPlatform.HashTable.getInstance=function(){if(!this.__instance__){this.__instance__=new AppPlatform.HashTable();};return this.__instance__;};AppPlatform.Element={getElementLeft:function(e){return(e==null)?0:(AppPlatform.$(e).offsetLeft+AppPlatform.Element.getElementLeft(AppPlatform.$(e).offsetParent));},getElementTop:function(e){return(e==null)?0:(AppPlatform.$(e).offsetTop+AppPlatform.Element.getElementTop(AppPlatform.$(e).offsetParent));},scrollIntoView:function(e){var x=AppPlatform.Element.getElementLeft(e);var y=AppPlatform.Element.getElementTop(e);window.scrollTo(x,y);},remove:function(){for(var i=0;i<arguments.length;i++){try
{AppPlatform.$(arguments[i]).parentNode.removeChild(AppPlatform.$(arguments[i]));}catch(e){}}}};AppPlatform.Page={getPageWidth:function(){return document.body.scrollWidth||document.documentElement.scrollWidth||0;},getPageHeight:function(){return document.body.scrollHeight||document.documentElement.scrollHeight||0;},getBodyWidth:function(){return document.body.clientWidth||document.documentElement.clientWidth||0;},getBodyTop:function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;}};if(typeof AppPlatform.Survey=="undefined"){AppPlatform.Survey=new Object();}AppPlatform.Survey.Input={className:"question",result:false,showResult:true,check:function(){var focus=null;for(key in AppPlatform.Survey.Option.list){if(-1==AppPlatform.Survey.Option.list[key]["isNeed"]){var selNum=0;if((0==AppPlatform.Survey.Option.list[key]["type"])||(1==AppPlatform.Survey.Option.list[key]["type"])){var checkObjArray=document.getElementsByName("sbj_"+key+"[]");for(i=0;i<checkObjArray.length;i++){if(checkObjArray[i].checked){if(0==AppPlatform.Survey.Option.list[key][checkObjArray[i].value]["other"]){selNum++;}else
{var OptInput=document.getElementById("opt_text_"+checkObjArray[i].value);if(OptInput.value.empty()){checkObjArray[i].checked=false;}else
{selNum++;}}continue;}}}else
{var checkObjArray=document.getElementsByName("sbj_"+key+"[]");if(!checkObjArray[0].value.empty()){for(var key2 in AppPlatform.Survey.Option.list[key]){if(!isNaN(key2)){checkObjArray[0].value=checkObjArray[0].value.trim();if(AppPlatform.Survey.Option.list[key][key2].minlen<=checkObjArray[0].value.length){selNum++;}}}}}if(selNum==0){AppPlatform.$("question_"+key).className=AppPlatform.Survey.Input.className+" focus";if(focus==null){focus="question_"+key;}}}}if(focus!=null){alert("对不起，请完成必选题后再提交");AppPlatform.Element.scrollIntoView(focus);return;}if(AppPlatform.Survey.User.needCheckQQ&&AppPlatform.Survey.User.getUin()==0){AppPlatform.Survey.User.LoginBox.login();return;}else
{AppPlatform.$("form_survey").submit();AppPlatform.$("submit_survey").value="提交中";AppPlatform.$("submit_survey").disabled=true;}},callback:function(code,msg){try
{window.frames["Ansy_Post"].location.replace("about:blank");}catch(e){}var errmsg="";var redo=false;switch(code){case"0":if(AppPlatform.Survey.Input.showResult){for(var key in AppPlatform.Survey.Option.list){var checkObjArray=document.getElementsByName("sbj_"+key+"[]");for(var i=0;i<checkObjArray.length;i++){checkObjArray[i].disabled=true;if((0==AppPlatform.Survey.Option.list[key]["type"])||(1==AppPlatform.Survey.Option.list[key]["type"])){if(1==AppPlatform.Survey.Option.list[key][checkObjArray[i].value]["other"]){document.getElementById("opt_text_"+checkObjArray[i].value).disabled=true;}}}AppPlatform.$("question_"+key).className="question result";for(var key2 in AppPlatform.Survey.Option.list[key]["result"]){try
{if((0==AppPlatform.Survey.Option.list[key]["type"])||(1==AppPlatform.Survey.Option.list[key]["type"])){AppPlatform.$("result_bar_"+key+"_"+key2).style.display="block";AppPlatform.$("process_txt_"+key+"_"+key2).style.display="block";}}catch(e){}}}if(AppPlatform.Survey.Input.result){var msgArray=msg.split("|");for(var i=0;i<msgArray.length;i++){try
{var subjId=msgArray[i].split("-")[0];var subjArray=msgArray[i].split("-")[1].split(";");for(var j=0;j<subjArray.length;j++){AppPlatform.Survey.Option.list[subjId]["count"]++;AppPlatform.Survey.Option.list[subjId]["result"][subjArray[j].split(":")[0]]["count"]++;AppPlatform.$("process_txt_"+subjId+"_"+subjArray[j].split(":")[0]).style.color="red";AppPlatform.$("process_txt_"+subjId+"_"+subjArray[j].split(":")[0]).style.fontWeight="bold";}}catch(e){}}AppPlatform.Survey.Option.showResult(true);}else
{var msgArray=msg.split("|");for(var i=0;i<msgArray.length;i++){try
{var subjId=msgArray[i].split("-")[0];var subjArray=msgArray[i].split("-")[1].split(";");for(var j=0;j<subjArray.length;j++){AppPlatform.Survey.Option.initCount(subjId,subjArray[j].split(":")[0],subjArray[j].split(":")[1],subjArray[j].split(":")[2]);}}catch(e){}}AppPlatform.Survey.Option.showResult();try
{AppPlatform.$("view_result").style.visibility="hidden";}catch(e){}}}else
{for(var key in AppPlatform.Survey.Option.list){var checkObjArray=document.getElementsByName("sbj_"+key+"[]");for(var i=0;i<checkObjArray.length;i++){checkObjArray[i].disabled=true;if((0==AppPlatform.Survey.Option.list[key]["type"])||(1==AppPlatform.Survey.Option.list[key]["type"])){if(1==AppPlatform.Survey.Option.list[key][checkObjArray[i].value]["other"]){document.getElementById("opt_text_"+checkObjArray[i].value).disabled=true;}}}}}AppPlatform.$("submit_survey").value="提交成功";AppPlatform.Survey.Page.resize(); setHeight();jQuery('#tipsBg').show();jQuery('#fcTips').show();break;case"3":errmsg="对不起，该调查尚未开始，请稍侯参与";redo=true;break;case"4":errmsg="对不起，该调查已结束";break;case"5":errmsg="";alert("对不起，该调查尚未发布");break;case"6":errmsg="对不起，该调查下没有任何调查题";break;case"7":errmsg="对不起，请完成必选题后再提交";redo=true;break;case"8":errmsg="对不起，您所选择的选项过多";redo=true;break;case"9":errmsg="对不起，您提交的选项有问题，请重新选择";redo=true;break;case"11":errmsg="对不起，您已参与过此调查，请勿重复提交";redo=true;break;case"14":AppPlatform.Survey.User.login();redo=false;break;case"1":case"2":case"10":case"12":default:for(var key in AppPlatform.Survey.Option.list){var checkObjArray=document.getElementsByName("sbj_"+key+"[]");for(var i=0;i<checkObjArray.length;i++){checkObjArray[i].disabled=true;if((0==AppPlatform.Survey.Option.list[key]["type"])||(1==AppPlatform.Survey.Option.list[key]["type"])){if(1==AppPlatform.Survey.Option.list[key][checkObjArray[i].value]["other"]){document.getElementById("opt_text_"+checkObjArray[i].value).disabled=true;}}}}if(AppPlatform.Survey.Input.showResult){if(AppPlatform.Survey.Input.result){var msgArray=msg.split("|");for(var i=0;i<msgArray.length;i++){try
{var subjId=msgArray[i].split("-")[0];var subjArray=msgArray[i].split("-")[1].split(";");for(var j=0;j<subjArray.length;j++){AppPlatform.Survey.Option.list[subjId]["count"]++;AppPlatform.Survey.Option.list[subjId]["result"][subjArray[j].split(":")[0]]["count"]++;AppPlatform.$("process_txt_"+subjId+"_"+subjArray[j].split(":")[0]).style.color="red";AppPlatform.$("process_txt_"+subjId+"_"+subjArray[j].split(":")[0]).style.fontWeight="bold";}}catch(e){}}AppPlatform.Survey.Option.showResult(true);}}AppPlatform.$("submit_survey").value="提交成功"; setHeight();AppPlatform.Survey.Page.resize();jQuery('#tipsBg').show();jQuery('#fcTips').show();break;}if(errmsg!=""){alert(errmsg);}if(redo){AppPlatform.$("submit_survey").value="提 交";AppPlatform.$("submit_survey").disabled=false;}}};AppPlatform.Survey.Option={list:[],initList:function(subjId,isNeed,subjType){if(1==isNeed){AppPlatform.Survey.Option.list[subjId]={"isNeed":-1,"count":0,"result":{"count":0,"percent":0},"type":subjType};}else
{AppPlatform.Survey.Option.list[subjId]={"isNeed":1,"count":0,"result":{"count":0,"percent":0},"type":subjType};}},initOption:function(subjId,optId,optOther,maxLen,minLen){AppPlatform.Survey.Option.list[subjId][optId]={"other":optOther,"maxlen":maxLen,"minlen":minLen};},initCount:function(subjId,optId,count,percent){try
{count=count==""?0:parseInt(count);percent=percent==""?0:parseFloat(percent);percent=parseFloat(percent).toFixed(2);AppPlatform.Survey.Option.list[subjId]["count"]+=count;AppPlatform.Survey.Option.list[subjId]["result"][optId]={"count":count,"percent":percent};}catch(e){}},showResult:function(account){var total=0;for(key in AppPlatform.Survey.Option.list){for(key2 in AppPlatform.Survey.Option.list[key]["result"]){try
{if(account){if(AppPlatform.Survey.Option.list[key]["count"]!=0){AppPlatform.Survey.Option.list[key]["result"][key2]["percent"]=parseFloat(AppPlatform.Survey.Option.list[key]["result"][key2]["count"]*100/AppPlatform.Survey.Option.list[key]["count"]).toFixed(2);}}AppPlatform.$("process_txt_"+key+"_"+key2).innerHTML="<nobr>"+AppPlatform.Survey.Option.list[key]["result"][key2]["count"].format()+" ("+parseFloat(AppPlatform.Survey.Option.list[key]["result"][key2]["percent"]).toFixed(2)+"%)</nobr>";if((0==AppPlatform.Survey.Option.list[key]["type"])||(1==AppPlatform.Survey.Option.list[key]["type"])){AppPlatform.$("result_bar_"+key+"_"+key2).style.display="block";AppPlatform.$("process_txt_"+key+"_"+key2).style.display="block";}total+=AppPlatform.Survey.Option.list[key]["result"][key2]["count"];}catch(e){}}}try
{AppPlatform.$("hot").style.visibility="visible";AppPlatform.$("hot_value").innerHTML=total.format();}catch(e){}AppPlatform.Survey.Option._processLength=0;AppPlatform.Survey.Option._processTimer=window.setInterval(AppPlatform.Survey.Option.setProcessLength,10);},_processTimer:null,_processLength:0,setProcessLength:function(){AppPlatform.Survey.Option._processLength+=3;var flag=0;for(key in AppPlatform.Survey.Option.list){for(key2 in AppPlatform.Survey.Option.list[key]["result"]){try
{if(AppPlatform.Survey.Option._processLength<=AppPlatform.Survey.Option.list[key]["result"][key2]["percent"]*1.6+3){flag=1;if(AppPlatform.Survey.Option._processLength>AppPlatform.Survey.Option.list[key]["result"][key2]["percent"]*1.6){AppPlatform.$("process_bar_"+key+"_"+key2).style.width=AppPlatform.Survey.Option.list[key]["result"][key2]["percent"]*1.6+"px";}else
{AppPlatform.$("process_bar_"+key+"_"+key2).style.width=AppPlatform.Survey.Option._processLength+"px";}}}catch(e){}}}if(flag==0){window.clearInterval(AppPlatform.Survey.Option._processTimer);}},check:function(checkObj,subjId,checkObjName,maxNum){var selNum=0;var checkObjArray=document.getElementsByName(checkObjName);for(i=0;i<checkObjArray.length;i++){if(checkObjArray[i].checked){selNum++;}}if(selNum>maxNum&&maxNum!=0){alert("对不起，本题最多只能选择"+maxNum+"个选项");checkObj.checked=false;}AppPlatform.$("question_"+subjId).className=AppPlatform.Survey.Input.className;},checkInput:function(checkObj,subjId,maxNum,optId,maxLen,minLen){if((0==AppPlatform.Survey.Option.list[subjId]["type"])||(1==AppPlatform.Survey.Option.list[subjId]["type"])){if(checkObj.value.empty()){document.getElementById("opt_"+optId).checked=false;}else
{var selNum=0;var checkObjArray=document.getElementsByName("sbj_"+subjId+"[]");for(i=0;i<checkObjArray.length;i++){if(checkObjArray[i].checked){selNum++;}}if(selNum>maxNum&&maxNum!=0){alert("对不起，本题最多只能选择"+maxNum+"个选项，请取消其它选项，再输入，谢谢！");checkObj.value="";}else
{document.getElementById("opt_"+optId).checked=true;}if(checkObj.value.length>maxLen){checkObj.value=checkObj.value.subTextStr(maxLen);}if(checkObj.value.empty()){document.getElementById("opt_"+optId).checked=false;}if(document.getElementById("opt_"+optId).checked){AppPlatform.$("question_"+subjId).className=AppPlatform.Survey.Input.className;}}}else
{if(checkObj.value.length>maxLen){checkObj.value=checkObj.value.subTextStr(maxLen);}document.getElementById("text_curlen_"+subjId).innerHTML=checkObj.value.length;if(checkObj.value.length>=minLen){AppPlatform.$("question_"+subjId).className=AppPlatform.Survey.Input.className;}}},setInnerText:function(objId,textValue){document.getElementById(objId).innerHTML=textValue;}};AppPlatform.Survey.Page={type:"index",id:0,resize:function(pjtId){if(typeof pjtId!="undefined"){AppPlatform.Survey.Page.id=parseInt(pjtId);}if(AppPlatform.Survey.Page.type=="mini"){try
{window.parent.AppPlatform.Survey.resetIframe(AppPlatform.Page.getPageHeight(),AppPlatform.Survey.Page.id);}catch(e){}}}};AppPlatform.Survey.User={needCheckQQ:false,init:function(){AppPlatform.Survey.User.needCheckQQ=true;if(AppPlatform.Survey.User.getUin()==0){AppPlatform.$("submit_survey").value="登录并提交";}},getUin:function(){if(AppPlatform.Cookie.getCookie("luin")&&AppPlatform.Cookie.getCookie("lskey")||(AppPlatform.Cookie.getCookie("uin")&&AppPlatform.Cookie.getCookie("skey"))){if(AppPlatform.Cookie.getCookie("luin")){return parseInt(AppPlatform.Cookie.getCookie("luin").replace(/^o0*/,""));}else{return parseInt(AppPlatform.Cookie.getCookie("uin").replace(/^o0*/,""));}}else
{return 0;}},login:function(callback){AppPlatform.Survey.User.LoginBox.login(callback);},LoginBox:{show:function(callback){AppPlatform.$("Float").style.width=AppPlatform.Page.getPageWidth()+"px";AppPlatform.$("Float").style.height=AppPlatform.Page.getPageHeight()+"px";AppPlatform.$("Float").style.display="block";AppPlatform.$("Login_Box").style.left=(AppPlatform.Page.getBodyWidth()-340)/2+"px";AppPlatform.$("Login_Box").style.top=AppPlatform.Page.getBodyTop()+100+"px";AppPlatform.$("Login_Box").style.display="block";AppPlatform.$("Login_Frame").src="http://ui.ptlogin2.qq.com/cgi-bin/login?link_target=blank&f_url=loginerroralert&hide_title_bar=1&style=1&target=self&appid=5000501&s_url=//www.qq.com/apps/html/login.html";AppPlatform.Survey.User.LoginBox.oY=AppPlatform.Page.getBodyTop();AppPlatform.Survey.User.LoginBox.oTimer=window.setInterval(AppPlatform.Survey.User.LoginBox.scroll,1);},hide:function(){AppPlatform.$("Float").style.display="none";AppPlatform.$("Login_Box").style.display="none";AppPlatform.$("Login_Frame").src="about:blank";window.clearInterval(AppPlatform.Survey.User.LoginBox.oTimer);},oY:0,oTimer:null,scroll:function(){var winY=AppPlatform.Page.getBodyTop();var curY=AppPlatform.Element.getElementTop("Login_Box");var percent=0.2*(winY-AppPlatform.Survey.User.LoginBox.oY);if(percent>0){percent=Math.ceil(percent);}else
{percent=Math.floor(percent);}AppPlatform.$("Login_Box").style.top=curY+percent+"px";AppPlatform.Survey.User.LoginBox.oY+=percent;AppPlatform.$("Float").style.width=AppPlatform.Page.getPageWidth()+"px";AppPlatform.$("Float").style.height=AppPlatform.Page.getPageHeight()+"px";AppPlatform.$("Float").style.display="block";},login:function(callback){AppPlatform.HashTable.getInstance().set("login_callback",callback);this.show();},ok:function(){if(typeof AppPlatform.HashTable.getInstance().get("login_callback")=="function"){AppPlatform.HashTable.getInstance().get("login_callback")();AppPlatform.HashTable.getInstance().remove("login_callback");}else
{AppPlatform.Survey.Input.check();}this.hide();},cancel:function(){AppPlatform.HashTable.getInstance().remove("login_callback");this.hide();}}};/*  |xGv00|1cc073d349105eada8570b6f03d3bee8 */